<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Call</title>
    <script src="./vendor/twilio.min.js"></script>
    <script src="./js/misc.js"></script>
</head>
<body>
  <input type="text" id="phone-number-input"/>
  <button id="callout-button">発信</button>
  <button id="hangup-button">終了</button>

  <script>
    (async function(){
      const {detectPhoneNumber} = await import("./js/phone-number.js");
      const {Api} = await import("./js/api.js");

      const api = new Api("/");

      document.getElementById("callout-button").addEventListener("click", async e => {
        const input = document.getElementById("phone-number-input").value.trim();
        if( input !== "" ){
          const result = detectPhoneNumber(input);
          if( result && result.length > 0 ){
            const num = result[0].phone;
            alert(num);
            const token = await api.getTwilioToken();
            console.log(token);
          }
        }

      });
    })();
  </script>
</body>
</html>